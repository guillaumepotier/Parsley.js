/*!
* parsley
* Guillaume Potier - <guillaume@wisembly.com>
* Version 2.0.0-pre - built Wed Jan 22 2014 23:38:58
* MIT Licensed
*
*/
/*!
* validator.js
* Guillaume Potier - <guillaume@wisembly.com>
* Version 0.5.1 - built Sun Jan 05 2014 17:05:46
* MIT Licensed
*
*/
(function(e,t){var n={attr:function(e,t,n){var r,i={},s=new RegExp("^"+t,"i");if("undefined"==typeof e||"undefined"==typeof e[0])return{};for(var o in e[0].attributes){r=e[0].attributes[o];if("undefined"!=typeof r&&null!==r&&r.specified&&s.test(r.name)){if("undefined"!=typeof n&&(new RegExp(n,"i")).test(r.name))return!0;i[this.camelize(r.name.replace(t,""))]=this.deserializeValue(r.value)}}return"undefined"==typeof n?i:!1},setAttr:function(e,t,n,r){e[0].setAttribute(this.dasherize(t+n),new String(r))},get:function(e,t,n){var r=0,i=(t||"").split(".");while(this.isObject(e)||this.isArray(e)){e=e[i[r++]];if(r===i.length)return e||n}return n},hash:function(e){return(new String(Math.random())).substring(2,e?e+2:9)},isArray:function(e){return Object.prototype.toString.call(e)==="[object Array]"},isObject:function(e){return e===Object(e)},deserializeValue:function(e){var t;try{return e?e=="true"||(e=="false"?!1:e=="null"?null:isNaN(t=Number(e))?/^[\[\{]/.test(e)?$.parseJSON(e):e:t):e}catch(n){return e}},camelize:function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},dasherize:function(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}},r={namespace:"data-parsley-",inputs:"input, textarea, select",excluded:"input[type=button], input[type=submit], input[type=reset]",priorityEnabled:!0,focus:"first",trigger:!1,errorClass:"parsley-error",successClass:"parsley-success",classHandler:function(e){},errorsContainer:function(e){},errorsWrapper:'<ul class="parsley-errors-list"></ul>',errorTemplate:"<li></li>"},i=function(e){};i.prototype={actualizeOptions:function(){return this.options=this.parsleyInstance.OptionsFactory.get(this),this},registerValidator:function(t,n,r){return e.ParsleyValidator.addValidator(t,n,r),this},removeValidator:function(t){return e.ParsleyValidator.removeValidator(t),this},updateValidator:function(e,t,n){return this.registerValidator(e,t,n)},subscribe:function(e,t){return $.subscribeTo(this,e,t),this},unsubscribe:function(e){return $.unsubscribeTo(this,e),this}},function(e){var t=function(e){return this.__class__="Validator",this.__version__="0.5.1",this.options=e||{},this.bindingKey=this.options.bindingKey||"_validatorjsConstraint",this};t.prototype={constructor:t,validate:function(e,t,n){if("string"!=typeof e&&"object"!=typeof e)throw new Error("You must validate an object or a string");return"string"==typeof e?this._validateString(e,t,n):this.isBinded(e)?this._validateBindedObject(e,t):this._validateObject(e,t,n)},bind:function(e,t){if("object"!=typeof e)throw new Error("Must bind a Constraint to an object");return e[this.bindingKey]=new n(t),this},unbind:function(e){return"undefined"==typeof e._validatorjsConstraint?this:(delete e[this.bindingKey],this)},isBinded:function(e){return"undefined"!=typeof e[this.bindingKey]},getBinded:function(e){return this.isBinded(e)?e[this.bindingKey]:null},_validateString:function(e,t,n){var s,u=[];o(t)||(t=[t]);for(var a=0;a<t.length;a++){if(!(t[a]instanceof i))throw new Error("You must give an Assert or an Asserts array to validate a string");s=t[a].check(e,n),s instanceof r&&u.push(s)}return u.length?u:!0},_validateObject:function(e,t,r){if("object"!=typeof t)throw new Error("You must give a constraint to validate an object");return t instanceof n?t.check(e,r):(new n(t)).check(e,r)},_validateBindedObject:function(e,t){return e[this.bindingKey].check(e,t)}},t.errorCode={must_be_a_string:"must_be_a_string",must_be_an_array:"must_be_an_array",must_be_a_number:"must_be_a_number"};var n=function(e,t){this.__class__="Constraint",this.options=t||{},this.nodes={};if(e)try{this._bootstrap(e)}catch(n){throw new Error("Should give a valid mapping object to Constraint",n,e)}return this};n.prototype={constructor:n,check:function(e,t){var n,r={};for(var u in this.options.strict?this.nodes:e)if(this.options.strict?this.has(u,e):this.has(u)){n=this._check(u,e[u],t);if(o(n)&&n.length>0||!o(n)&&!s(n))r[u]=n}else if(this.options.strict)try{(new i).HaveProperty(u).validate(e)}catch(a){r[u]=a}return s(r)?!0:r},add:function(e,t){if(t instanceof i||o(t)&&t[0]instanceof i)return this.nodes[e]=t,this;if("object"==typeof t&&!o(t))return this.nodes[e]=t instanceof n?t:new n(t),this;throw new Error("Should give an Assert, an Asserts array, a Constraint",t)},has:function(e,t){var t="undefined"!=typeof t?t:this.nodes;return"undefined"!=typeof t[e]},get:function(e,t){return this.has(e)?this.nodes[e]:t||null},remove:function(e){var t=[];for(var n in this.nodes)n!==e&&(t[n]=this.nodes[n]);return this.nodes=t,this},_bootstrap:function(e){if(e instanceof n)return this.nodes=e.nodes;for(var t in e)this.add(t,e[t])},_check:function(e,t,r){if(this.nodes[e]instanceof i)return this._checkAsserts(t,[this.nodes[e]],r);if(o(this.nodes[e]))return this._checkAsserts(t,this.nodes[e],r);if(this.nodes[e]instanceof n)return this.nodes[e].check(t,r);throw new Error("Invalid node",this.nodes[e])},_checkAsserts:function(e,t,n){var r,i=[];for(var s=0;s<t.length;s++)r=t[s].check(e,n),"undefined"!=typeof r&&!0!==r&&i.push(r);return i}};var r=function(e,t,n){this.__class__="Violation";if(!(e instanceof i))throw new Error("Should give an assertion implementing the Assert interface");this.assert=e,this.value=t,"undefined"!=typeof n&&(this.violation=n)};r.prototype={show:function(){var e={assert:this.assert.__class__,value:this.value};return this.violation&&(e.violation=this.violation),e},__toString:function(){if("undefined"!=typeof this.violation)var e='", '+this.getViolation().constraint+" expected was "+this.getViolation().expected;return this.assert.__class__+' assert failed for "'+this.value+e||""},getViolation:function(){var e,t;for(e in this.violation)t=this.violation[e];return{constraint:e,expected:t}}};var i=function(e){return this.__class__="Assert",this.__parentClass__=this.__class__,this.groups=[],"undefined"!=typeof e&&this.addGroup(e),this};i.prototype={construct:i,check:function(e,t){if(t&&!this.hasGroup(t))return;if(!t&&this.hasGroups())return;try{return this.validate(e,t)}catch(n){return n}},hasGroup:function(e){return o(e)?this.hasOneOf(e):"Any"===e?!0:this.hasGroups()?-1!==this.groups.indexOf(e):"Default"===e},hasOneOf:function(e){for(var t=0;t<e.length;t++)if(this.hasGroup(e[t]))return!0;return!1},hasGroups:function(){return this.groups.length>0},addGroup:function(e){return o(e)?this.addGroups(e):(this.hasGroup(e)||this.groups.push(e),this)},removeGroup:function(e){var t=[];for(var n=0;n<this.groups.length;n++)e!==this.groups[n]&&t.push(this.groups[n]);return this.groups=t,this},addGroups:function(e){for(var t=0;t<e.length;t++)this.addGroup(e[t]);return this},HaveProperty:function(e){return this.__class__="HaveProperty",this.node=e,this.validate=function(e){if("undefined"==typeof e[this.node])throw new r(this,e,{value:this.node});return!0},this},Blank:function(){return this.__class__="Blank",this.validate=function(e){if("string"!=typeof e)throw new r(this,e,{value:t.errorCode.must_be_a_string});if(""!==e.replace(/^\s+/g,"").replace(/\s+$/g,""))throw new r(this,e);return!0},this},Callback:function(e){this.__class__="Callback",this.arguments=Array.prototype.slice.call(arguments),1===this.arguments.length?this.arguments=[]:this.arguments.splice(0,1);if("function"!=typeof e)throw new Error("Callback must be instanciated with a function");return this.fn=e,this.validate=function(e){var t=[e].concat(this.arguments),n=this.fn.apply(this,t);if(!0!==n)throw new r(this,e,{result:n});return!0},this},Choice:function(e){this.__class__="Choice";if(!o(e)&&"function"!=typeof e)throw new Error("Choice must be instanciated with an array or a function");return this.list=e,this.validate=function(e){var t="function"==typeof this.list?this.list():this.list;for(var n=0;n<t.length;n++)if(e===t[n])return!0;throw new r(this,e,{choices:t})},this},Collection:function(e){return this.__class__="Collection",this.constraint="undefined"!=typeof e?new n(e):!1,this.validate=function(e,n){var i,u=new t,a=0,f={},l=this.groups.length?this.groups:n;if(!o(e))throw new r(this,array,{value:t.errorCode.must_be_an_array});for(var c=0;c<e.length;c++)i=this.constraint?u.validate(e[c],this.constraint,l):u.validate(e[c],l),s(i)||(f[a]=i),a++;return s(f)?!0:f},this},Count:function(e){return this.__class__="Count",this.count=e,this.validate=function(e){if(!o(e))throw new r(this,e,{value:t.errorCode.must_be_an_array});var n="function"==typeof this.count?this.count(e):this.count;if(isNaN(Number(n)))throw new Error("Count must be a valid interger",n);if(n!==e.length)throw new r(this,e,{count:n});return!0},this},Email:function(){return this.__class__="Email",this.validate=function(e){var n=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;if("string"!=typeof e)throw new r(this,e,{value:t.errorCode.must_be_a_string});if(!n.test(e))throw new r(this,e);return!0},this},Eql:function(e){this.__class__="Eql";if("undefined"==typeof e)throw new Error("Equal must be instanciated with an Array or an Object");return this.eql=e,this.validate=function(e){var t="function"==typeof this.eql?this.eql(e):this.eql;if(!u.eql(t,e))throw new r(this,e,{eql:t});return!0},this},EqualTo:function(e){this.__class__="EqualTo";if("undefined"==typeof e)throw new Error("EqualTo must be instanciated with a value or a function");return this.reference=e,this.validate=function(e){var t="function"==typeof this.reference?this.reference(e):this.reference;if(t!==e)throw new r(this,e,{value:t});return!0},this},GreaterThan:function(e){this.__class__="GreaterThan";if("undefined"==typeof e)throw new Error("Should give a threshold value");return this.threshold=e,this.validate=function(e){if(isNaN(Number(e)))throw new r(this,e,{value:t.errorCode.must_be_a_number});if(this.threshold>=e)throw new r(this,e,{threshold:this.threshold});return!0},this},GreaterThanOrEqual:function(e){this.__class__="GreaterThanOrEqual";if("undefined"==typeof e)throw new Error("Should give a threshold value");return this.threshold=e,this.validate=function(e){if(this.threshold>e)throw new r(this,e,{threshold:this.threshold});return!0},this},InstanceOf:function(e){this.__class__="InstanceOf";if("undefined"==typeof e)throw new Error("InstanceOf must be instanciated with a value");return this.classRef=e,this.validate=function(e){if(1!=e instanceof this.classRef)throw new r(this,e,{classRef:this.classRef});return!0},this},IPv4:function(){return this.__class__="IPv4",this.validate=function(e){var n=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;if("string"!=typeof e)throw new r(this,e,{value:t.errorCode.must_be_a_string});if(!n.test(e))throw new r(this,e);return!0},this},Length:function(e){this.__class__="Length";if(!e.min&&!e.max)throw new Error("Lenth assert must be instanciated with a { min: x, max: y } object");return this.min=e.min,this.max=e.max,this.validate=function(e){if("string"!=typeof e)throw new r(this,e,{value:t.errorCode.must_be_a_string});if("undefined"!=typeof this.min&&this.min===this.max&&e.length!==this.min)throw new r(this,e,{min:this.min,max:this.max});if("undefined"!=typeof this.max&&e.length>this.max)throw new r(this,e,{max:this.max});if("undefined"!=typeof this.min&&e.length<this.min)throw new r(this,e,{min:this.min});return!0},this},LessThan:function(e){this.__class__="LessThan";if("undefined"==typeof e)throw new Error("Should give a threshold value");return this.threshold=e,this.validate=function(e){if(isNaN(Number(e)))throw new r(this,e,{value:t.errorCode.must_be_a_number});if(this.threshold<=e)throw new r(this,e,{threshold:this.threshold});return!0},this},LessThanOrEqual:function(e){this.__class__="LessThanOrEqual";if("undefined"==typeof e)throw new Error("Should give a threshold value");return this.threshold=e,this.validate=function(e){if(this.threshold<e)throw new r(this,e,{threshold:this.threshold});return!0},this},Mac:function(){return this.__class__="Mac",this.validate=function(e){var n=/^(?:[0-9A-F]{2}:){5}[0-9A-F]{2}$/i;if("string"!=typeof e)throw new r(this,e,{value:t.errorCode.must_be_a_string});if(!n.test(e))throw new r(this,e);return!0},this},NotNull:function(){return this.__class__="NotNull",this.validate=function(e){if(null===e||"undefined"==typeof e)throw new r(this,e);return!0},this},NotBlank:function(){return this.__class__="NotBlank",this.validate=function(e){if("string"!=typeof e)throw new r(this,e,{value:t.errorCode.must_be_a_string});if(""===e.replace(/^\s+/g,"").replace(/\s+$/g,""))throw new r(this,e);return!0},this},Null:function(){return this.__class__="Null",this.validate=function(e){if(null!==e)throw new r(this,e);return!0},this},Range:function(e,t){if(!e||!t)throw new Error("Range assert expects min and max values");return this.LengthValidator=(new i).Length({min:e,max:t}),this.__class__="Range",this.validate=function(e){try{this.LengthValidator.validate(e)}catch(t){throw new r(this,e,t.violation)}return!0},this},Regexp:function(e,n){this.__class__="Regexp";if("undefined"==typeof e)throw new Error("You must give a regexp");return this.regexp=e,this.flag=n||"",this.validate=function(e){if("string"!=typeof e)throw new r(this,e,{value:t.errorCode.must_be_a_string});if(!(new RegExp(this.regexp)).test(e,this.flag))throw new r(this,e,{regexp:this.regexp,flag:this.flag});return!0},this},Required:function(){return this.__class__="Required",this.validate=function(e){if("undefined"==typeof e)throw new r(this,e);if("string"==typeof e)try{(new i).NotNull().validate(e)&&(new i).NotBlank().validate(e)}catch(t){throw new r(this,e)}return!0},this},Unique:function(e){return this.__class__="Unique","object"==typeof e&&(this.key=e.key),this.validate=function(e){var n,i=[];if(!o(e))throw new r(this,e,{value:t.errorCode.must_be_an_array});for(var s=0;s<e.length;s++){n="object"==typeof e[s]?e[s][this.key]:e[s];if("undefined"==typeof n)continue;if(-1!==i.indexOf(n))throw new r(this,e,{value:n});i.push(n)}return!0},this}},e.Assert=i,e.Validator=t,e.Violation=r,e.Constraint=n,Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(this==null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:r!=0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1});var s=function(e){for(var t in e)return!1;return!0},o=function(e){return Object.prototype.toString.call(e)==="[object Array]"},u={eql:function(e,t){if(e===t)return!0;if("undefined"!=typeof Buffer&&Buffer.isBuffer(e)&&Buffer.isBuffer(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():typeof e!="object"&&typeof t!="object"?e==t:this.objEquiv(e,t)},isUndefinedOrNull:function(e){return e===null||typeof e=="undefined"},isArguments:function(e){return Object.prototype.toString.call(e)=="[object Arguments]"},keys:function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},objEquiv:function(e,t){if(this.isUndefinedOrNull(e)||this.isUndefinedOrNull(t))return!1;if(e.prototype!==t.prototype)return!1;if(this.isArguments(e))return this.isArguments(t)?eql(pSlice.call(e),pSlice.call(t)):!1;try{var n=this.keys(e),r=this.keys(t),i,s}catch(o){return!1}if(n.length!==r.length)return!1;n.sort(),r.sort();for(s=n.length-1;s>=0;s--)if(n[s]!=r[s])return!1;for(s=n.length-1;s>=0;s--){i=n[s];if(!this.eql(e[i],t[i]))return!1}return!0}};"function"==typeof define&&define.amd&&var s=function(e){this.__class__="ParsleyValidator",this.Validator=Validator,this.locale="en",this.init(e||{})};s.prototype={init:function(e){for(var t in e)this.addValidator(t,e[t].fn,e[t].priority)},validate:function(){return(new this.Validator.Validator).validate.apply(new Validator.Validator,arguments)},addValidator:function(e,t,n){return this.validators[e]=function(e){return $.extend((new Validator.Assert).Callback(t,e),{priority:n})},this},updateValidator:function(e,t,n){return addValidator(e,t,n)},removeValidator:function(e){return delete this.validators[e],this},setLocale:function(t){if("undefined"==typeof e.ParsleyConfig.i18n[t])throw new Error(t+" is not available in i18n dictionary");return this.locale=t,this},getErrorMessage:function(t){var n;return"type"===t.name?n=e.ParsleyConfig.i18n[this.locale].messages[t.name][t.requirements]:n=this.formatMesssage(e.ParsleyConfig.i18n[this.locale].messages[t.name],t.requirements),""!==n?n:e.ParsleyConfig.i18n[this.locale].messages.defaultMessage},formatMesssage:function(e,t){if("object"==typeof t){for(var n in t)e=this.formatMesssage(e,t[n]);return e}return"string"==typeof e?e.replace(new RegExp("%s","i"),t):""},validators:{notblank:function(){return $.extend((new Validator.Assert).NotBlank(),{priority:2})},required:function(){return $.extend((new Validator.Assert).Required(),{priority:512})},type:function(e){var t;switch(e){case"email":t=(new Validator.Assert).Email();break;case"number":t=(new Validator.Assert).Regexp("^-?(?:\\d+|\\d{1,3}(?:,\\d{3})+)?(?:\\.\\d+)?$");break;case"digits":t=(new Validator.Assert).Regexp("^\\d+$");break;case"alphanum":t=(new Validator.Asser).Regexp("^\\w+$","i");break;case"url":case"urlstrict":break;case"dateIso":break;case"tel":break;default:throw new Error("validator type `"+e+"` is not supported")}return $.extend(t,{priority:256})},pattern:function(e){return $.extend((new Validator.Assert).Regexp(e),{priority:64})},length:function(e){return $.extend((new Validator.Assert).Length({min:e[0],max:e[1]}),{priority:32})},minlength:function(e){return $.extend((new Validator.Assert).Length({min:e}),{priority:32})},maxlength:function(e){return $.extend((new Validator.Assert).Length({max:e}),{priority:32})}}};var o=function(e){this.__class__="ParsleyUI"};o.prototype={listen:function(){$.listen("parsley:field:init",this,this.setup),$.listen("parsley:field:validated",this,this.reflow),$.listen("parsley:form:validated",this,this.focus),$.listen("parsley:field:reset",this,this.reset),$.listen("parsley:field:destroy",this,this.destroy)},reflow:function(e){if(!1===e._ui.active)return;var t=this.diff(e.validationResult,e._ui.lastValidationResult);e._ui.lastValidationResult=e.validationResult,!0===e.validationResult?e.$element.removeClass(e.options.errorClass).addClass(e.options.successClass):e.validationResult.length>0?e.$element.removeClass(e.options.successClass).addClass(e.options.errorClass):e.$element.removeClass(e.options.successClass).removeClass(e.options.errorClass);for(var n=0;n<t.removed.length;n++)e._ui.$errorsWrapper.find(".parsley-"+t.removed[n].assert.name).remove();for(var n=0;n<t.added.length;n++)e._ui.$errorsWrapper.append($(e.options.errorTemplate).addClass("parsley-"+t.added[n].assert.name).html(this.getErrorMessage(e,t.added[n].assert)));for(var n=0;n<t.kept.length;n++)e._ui.$errorsWrapper.find(".parsley-"+t.kept[n].assert.name).html(this.getErrorMessage(e,t.kept[n].assert));this.actualizeTriggers(e),(t.kept.length||t.added.length)&&this.manageFailingFieldTrigger(e)},focus:function(e){if(!0===e.isValid||"none"===e.options.focus)return;for(var t=0;t<e.fields.length;t++)if(!0!==e.fields[t].validationResult&&e.fields[t].validationResult.length>0){if("first"===e.options.focus)return e.fields[t].$element.focus();var n=e.fields[t]}return n.$element.focus()},getErrorMessage:function(t,n){var r=n.name+"Message";return"undefined"!=typeof t.options[r]?t.options[r]:e.ParsleyValidator.getErrorMessage(n)},diff:function(e,t,n){var r=[],i=[];for(var s=0;s<e.length;s++){var o=!1;for(var u=0;u<t.length;u++)if(e[s].assert.name===t[u].assert.name){o=!0;break}o?i.push(e[s]):r.push(e[s])}return{kept:i,added:r,removed:n?[]:this.diff(t,e,!0).added}},setup:function(e){var t={active:!1};e.$element.attr(e.options.namespace+"id",e.__id__),t.$errorClassHandler=e.options.classHandler(e)||e.$element,"string"==typeof e.options.errorsContainer&&(t.$errorsContainer=$(e.options.errorsContainer)),"function"==typeof e.options.errorsContainer&&(t.$errorsContainer=e.options.errorsContainer(e)),t.errorsWrapperId="parsley-id-"+("undefined"!=typeof e.options.multiple?"multiple-"+e.options.multiple:e.__id__),t.$errorsWrapper=$(e.options.errorsWrapper).attr("id",t.errorsWrapperId),t.lastValidationResult=[],0===$("#"+t.errorsWrapperId).length&&(t.active=!0,"undefined"!=typeof t.$errorsContainer&&"undefined"!=typeof t.$errorsContainer[0]?t.$errorsContainer.append(t.$errorsWrapper):e.options.multiple?e.$element.parent().after(t.$errorsWrapper):e.$element.after(t.$errorsWrapper)),e._ui=t,this.actualizeTriggers(e)},actualizeTriggers:function(e){e.$element.off(".Parsley");if(!1===e.options.trigger)return;var t=e.options.trigger.replace(/^\s+/g,"").replace(/\s+$/g,"");if(""===t)return;e.$element.on(t.split(" ").join(".Parsley ")+".Parsley",!1,$.proxy(e.validate,e))},manageFailingFieldTrigger:function(e){e.options.multiple&&$("["+e.options.namespace+'multiple="'+e.options.multiple+'"]').each(function(){if(!(new RegExp("change","i")).test($(this).parsley().options.trigger||""))return $(this).parsley().$element.on("change.ParsleyFailedOnce",!1,$.proxy(e.validate,e))});if(!(new RegExp("keyup","i")).test(e.options.trigger||""))return e.$element.on("keyup.ParsleyFailedOnce",!1,$.proxy(e.validate,e))},reset:function(e){e.$element.off(".Parsley"),e.$element.off(".ParsleyFailedOnce")},destroy:function(e){this.reset()}};var u=function(e,t,r,i){this.__class__="OptionsFactory",this.__id__=n.hash(4),this.formOptions=null,this.fieldOptions=null,this.staticOptions=$.extend(!0,{},e,t,r,{namespace:i})};u.prototype={get:function(e){if("undefined"==typeof e.__class__)throw new Error("Parsley Instance expected");switch(e.__class__){case"Parsley":return this.staticOptions;case"ParsleyForm":return this.getFormOptions(e);case"ParsleyField":return this.getFieldOptions(e);default:throw new Error("Instance "+e.__class__+" is not supported")}},getFormOptions:function(e){return this.formOptions=n.attr(e.$element,this.staticOptions.namespace),$.extend({},this.staticOptions,this.formOptions)},getFieldOptions:function(e){return this.fieldOptions=n.attr(e.$element,this.staticOptions.namespace),$.extend({},this.staticOptions,this.formOptions,this.fieldOptions)}};var a=function(e,t){this.__class__="ParsleyForm",this.__id__=n.hash(4);if("Parsley"!==n.get(t,"__class__"))throw new Error("You must give a Parsley instance");this.parsleyInstance=t,this.init($(e))};a.prototype={init:function(e){this.$element=e,this.validationResult=null,this.options=this.parsleyInstance.OptionsFactory.get(this),this.bindFields(),this.$element.attr("novalidate","novalidate"),this.$element.on("submit.Parsley",!1,$.proxy(this.onSubmitValidate,this))},onSubmitValidate:function(e){return this.validate(t,e),!1===this.isValid&&e instanceof $.Event&&e.preventDefault(),this},validate:function(e,t){this.isValid=!0,this.submitEvent=t;var n=[];this.refreshFields(),$.emit("parsley:form:validate",this);for(var r=0;r<this.fields.length;r++){if(e&&e!==this.fields[r].options.group)continue;n=this.fields[r].validate().validationResult,!0!==n&&n.length>0&&this.isValid&&(this.isValid=!1)}return $.emit("parsley:form:validated",this),this},isValid:function(e){this.refreshFields();for(var t=0;t<this.fields.length;t++){if(e&&e!==this.fields[t].options.group)continue;if(!1===this.fields[t].isValid())return!1}return!0},refreshFields:function(){return this.actualizeOptions().bindFields()},bindFields:function(){var e=this;return this.fields=[],this.$element.find(this.options.inputs).each(function(){e.addField(this)}),this},addField:function(t){var n=new e.Parsley(t,{},this.parsleyInstance);return"ParsleyField"===n.__class__&&this.fields.push(n),this},removeField:function(e){},reset:function(){},destroy:function(){}};var f=function(t,r,i,s,o){if("ParsleyField"!==n.get(t,"__class__"))throw new Error("ParsleyField instance expected");if("function"!=typeof e.ParsleyValidator.validators[r]&&"Assert"!==e.ParsleyValidator.validators[r](i).__parentClass__)throw new Error("Valid validator expected");var u=function(t,r){return"undefined"!=typeof t.options[r+"Priority"]?t.options[r+"Priority"]:n.get(e.ParsleyValidator.validators[r](i),"priority",2)};return s=s||u(t,r),$.extend(e.ParsleyValidator.validators[r](i),{name:r,requirements:i,priority:s,groups:[s],isDomConstraint:o||n.attr(t.$element,t.options.namespace,r)})},l=function(e,t){this.__class__="ParsleyField",this.__id__=n.hash(4);if("Parsley"!==n.get(t,"__class__"))throw new Error("You must give a Parsley instance");this.parsleyInstance=t,this.init($(e),t.options)};l.prototype={init:function(e,t){this.constraints=[],this.$element=e,this.validationResult=[],this.options=this.parsleyInstance.OptionsFactory.get(this),this.$element.is("input[type=radio], input[type=checkbox]")&&"undefined"==typeof this.options.multiple&&(this.options.multiple=this.$element.attr("name").replace(/(:|\.|\[|\]|\$)/g,""),n.setAttr(this.$element,this.options.namespace,"multiple",this.options.multiple)),$.emit("parsley:field:init",this),this.bindConstraints()},validate:function(){return $.emit("parsley:field:validate",this),$.emit("parsley:field:"+(this.isValid()?"success":"error"),this),$.emit("parsley:field:validated",this),this},getConstraintsSortedPriorities:function(){var e=[];for(var t=0;t<this.constraints.length;t++)-1===e.indexOf(this.constraints[t].priority)&&e.push(this.constraints[t].priority);return e.sort(function(e,t){return t-e}),e},isValid:function(){var t=this.getConstraintsSortedPriorities();this.refreshConstraints();if(""===this.getVal()){var n=this.indexOfConstraint("required");if(-1===n||-1!==n&&!1===this.constraints[n].requirements)return this.validationResult=[]}if(!1===this.options.priorityEnabled)return!0===(this.validationResult=e.ParsleyValidator.validate(this.getVal(),this.constraints,"Any"));for(var r=0;r<t.length;r++)if(!0!==(this.validationResult=e.ParsleyValidator.validate(this.getVal(),this.constraints,t[r])))return!1;return!0},getVal:function(){if("undefined"!=typeof this.options.value)return this.options.value;if(this.$element.is("input[type=radio]"))return $("["+this.options.namespace+'multiple="'+this.options.multiple+'"]:checked').val()||"";if(this.$element.is("input[type=checkbox]")){var e=[];return $("["+this.options.namespace+'multiple="'+this.options.multiple+'"]:checked').each(function(){e.push($(this).val())}),e.length?e:""}return this.$element.val()},refreshConstraints:function(){return this.actualizeOptions().bindConstraints()},bindConstraints:function(){var e=[];for(var t=0;t<this.constraints.length;t++)!1===this.constraints[t].isDomConstraint&&e.push(this.constraints[t]);this.constraints=e;for(var n in this.options)this.addConstraint(n,this.options[n]);return this.bindHtml5Constraints()},bindHtml5Constraints:function(){(this.$element.hasClass("required")||this.$element.attr("required"))&&this.addConstraint("required",!0,t,!0),"string"==typeof this.$element.attr("pattern")&&this.addConstraint("pattern",this.$element.attr("pattern"),t,!0);var e=this.$element.attr("type");if("undefined"!=typeof e&&(new RegExp(e,"i")).test("email url number range tel")){this.addConstraint("type",e,t,!0);if("undefined"!=typeof this.$element.attr("min")&&"undefined"!=typeof this.$element.attr("max"))return this.addConstraint("range",[this.$element.attr("min"),this.$element.attr("max")],t,!0);if("undefined"!=typeof this.$element.attr("min"))return this.addConstraint("min",this.$element.attr("min"),t,!0);if("undefined"!=typeof this.$element.attr("max"))return this.addConstraint("max",this.$element.attr("max"),t,!0)}return this},addConstraint:function(t,n,r,i){return t=t.toLowerCase(),"function"==typeof e.ParsleyValidator.validators[t]&&(constraint=new f(this,t,n,r,i),-1!==this.indexOfConstraint(constraint.name)&&this.removeConstraint(constraint.name),this.constraints.push(constraint)),this},removeConstraint:function(e){for(var t=0;t<this.constraints.length;t++)if(e===this.constraints[t].name){this.constraints.splice(t,1);break}return this},updateConstraint:function(e,t,n){return this.removeConstraint(e).addConstraint(e,t,n)},indexOfConstraint:function(e){for(var t=0;t<this.constraints.length;t++)if(e===this.constraints[t].name)return t;return-1},reset:function(){$.emit("parsley:field:reset",this)},destroy:function(){$.emit("parsley:field:destroy",this)}};var c=$({}),h={};$.listen=function(e){"undefined"==typeof h[e]&&(h[e]=[]);if("function"==typeof arguments[1])return h[e].push({fn:arguments[1]});if("object"==typeof arguments[1]&&"function"==typeof arguments[2])return h[e].push({fn:arguments[2],ctxt:arguments[1]});throw new Error("Wrong parameters")},$.listenTo=function(e,t,n){"undefined"==typeof h[t]&&(h[t]=[]);if(!(e instanceof l||e instanceof a))throw new Error("Must give Parsley instance");if("string"!=typeof t||"function"!=typeof n)throw new Error("Wrong parameters");h[t].push({instance:e,fn:n})},$.unsubscribe=function(e,t){if("undefined"==typeof h[e])return;if("string"!=typeof e||"function"!=typeof t)throw new Error("Wrong arguments");for(var n=0;n<h[e].length;n++)if(h[e][n].fn===t)return h[e].splice(n,1)},$.unsubscribeTo=function(e,t){if("undefined"==typeof h[t])return;if(!(e instanceof l||e instanceof a))throw new Error("Must give Parsley instance");for(var n=0;n<h[t].length;n++)if("undefined"!=typeof h[t][n].instance&&h[t][n].instance.__id__===e.__id__)return h[t].splice(n,1)},$.unsubscribeAll=function(e){if("undefined"==typeof h[e])return;delete h[e]},$.emit=function(e,t){if("undefined"==typeof h[e])return;for(var n=0;n<h[e].length;n++){if("undefined"==typeof h[e][n].instance){h[e][n].fn.apply("undefined"!=typeof h[e][n].ctxt?h[e][n].ctxt:c,Array.prototype.slice.call(arguments,1));continue}if(!(t instanceof l||t instanceof a))continue;if(h[e][n].instance.__id__===t.__id__){h[e][n].fn.apply(c,Array.prototype.slice.call(arguments,1));continue}if(h[e][n].instance instanceof a&&t instanceof l)for(var r=0;r<h[e][n].instance.fields.length;r++)if(h[e][n].instance.fields[r].__id__===t.__id__){h[e][n].fn.apply(c,Array.prototype.slice.call(arguments,1));continue}}},$.subscribed=function(){return h},e.ParsleyConfig=e.ParsleyConfig||{},e.ParsleyConfig.i18n=e.ParsleyConfig.i18n||{},e.ParsleyConfig.i18n.en={messages:{defaultMessage:"This value seems to be invalid.",type:{email:"This value should be a valid email.",url:"This value should be a valid url.",urlstrict:"This value should be a valid url.",number:"This value should be a valid number.",digits:"This value should be digits.",dateIso:"This value should be a valid date (YYYY-MM-DD).",alphanum:"This value should be alphanumeric.",tel:"This value should be a valid phone number."},notnull:"This value should not be null.",notblank:"This value should not be blank.",required:"This value is required.",pattern:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or less.",length:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or less.",rangecheck:"You must select between %s and %s choices.",equalto:"This value should be the same."}},var p=function(e,t,r){this.__class__="Parsley",this.__version__="2.0.0-pre",this.__id__=n.hash(4);if("undefined"==typeof e)throw new Error("You must give an element");return this.init($(e),t,r)};p.prototype={init:function(t,i,s){this.$element=t;if(this.$element.data("Parsley"))return this.$element.data("Parsley");this.OptionsFactory=new u(r,n.get(e,"ParsleyConfig",{}),i,this.getNamespace(i));var i=this.OptionsFactory.staticOptions;return this.$element.is("form")||n.attr(this.$element,i.namespace,"validate")&&!this.$element.is(i.inputs)?this.bind("parsleyForm",s):this.$element.is(i.inputs)&&!this.$element.is(i.excluded)?this.bind("parsleyField",s):this},getNamespace:function(t){return"undefined"!=typeof this.$element.data("parsleyNamespace")?this.$element.data("parsleyNamespace"):"undefined"!=typeof n.get(t,"namespace")?t.namespace:"undefined"!=typeof n.get(e,"ParsleyConfig.namespace")?e.ParsleyConfig.namespace:r.namespace},bind:function(e,t){switch(e){case"parsleyForm":parsleyInstance=$.extend(new a(this.$element,t||this),new i);break;case"parsleyField":parsleyInstance=$.extend(new l(this.$element,t||this),new i);break;default:throw new Error(e+"is not a supported Parsley type")}return this.$element.data("Parsley",parsleyInstance),parsleyInstance}},$.fn.parsley=$.fn.psly=function(e){return new p(this,e)},o="function"==typeof n.get(e.ParsleyConfig,"ParsleyUI")?(new e.ParsleyConfig.ParsleyUI).listen():(new o).listen(),e.Parsley=e.psly=p,e.ParsleyUtils=n,e.ParsleyValidator=new s(n.get(e.ParsleyConfig,"validators")),!1!==n.get(e,"ParsleyConfig.autoBind")&&$(document).ready(function(){$("[parsley-validate], [data-parsley-validate]").each(function(){new p(this)})})})(window);